/*!
 * Version 0.3  
 * Adds simple touch drag and swipe listeners to jQuery.
 *
 * Requires jQuery 1.7 or later.
 *
 * This content is released under the MIT License
 * http://opensource.org/licenses/MIT
 *
 * Copyright (c) 2012 Tyler Ault
 */
(function(h){var j="startTouch",q="swipeCallback",f="touchDragCallback",t="touchDragHandler",l="touchDragCatcher",a="touchDragAxis",m="touchBubble",k="touchBindings",r="undefined",e=60,n=600,u=function(v){var w=v.originalEvent;if(w.touches&&w.touches.length){return w.touches}else{if(w.changedTouches&&w.changedTouches.length){return w.changedTouches}}},c=function(v){v.stopPropagation();v.preventDefault()},s=function(v){var y=h(v),x=y.data(t)||null,w=y.data(l)||null;if(x&&w){h(w).off({touchmove:x,touchend:x})}y.data(t,null)},g=function(E){var D=u(E),F=h(this),y,w,x,v;if(D.length>1){return}v=F.data(j);if(!v){return}y=F.data(f);x=F.data(a)||0;w=(x>0)?F:null;if(y||w){var C=D[0],B=C.pageX-v.pageX,A=C.pageY-v.pageY;try{if(w&&(x==1||x==3)){w.css("left",(v.left+B)+"px")}if(w&&x>1){w.css("top",(v.top+A)+"px")}}catch(z){}if(y){y.apply(w,[E,B,A,v.left,v.top])}}c(E)},b=function(A){var z=u(A),C=z[0],B=h(this).data(j);if(!B||typeof B==r){return}if(z.length>1){return}var x=C.pageX-B.pageX,w=C.pageY-B.pageY,y=e*e,v=h(this).data(q);if(x*x>y||w*w>y){if(v&&new Date().getTime()-B.time<n){v(A,x,w)}if(h(this).data(m)!==true){c(A)}}h(this).data(j,null);s(this)},p=function(v,x){var w=function(y){if(y.type=="touchmove"){g.apply(v,[y])}else{if(y.type=="touchend"){b.apply(v,[y]);s(v)}}};h(v).data(t,w);h(x).on({touchmove:w,touchend:w})},d=function(y){var x=u(y),A=x[0],v=h(this).data(l)||null,w=null,z=null;if(x.length>1){return}if(v){w=h(y.currentTarget);z=w.position();p(this,v)}h(this).data(j,{pageX:A.pageX,pageY:A.pageY,top:w?z.top:0,left:w?z.left:0,time:new Date().getTime()})},i=function(v,w){var x=v.data(k)||[];if(x.length<1){v.bind("touchstart",d).bind("touchend",b)}if(h.inArray(w,x)<0){x.push(w)}v.data(k,x)},o=function(w,x){var y=w.data(k)||[],v=h.inArray(x,y);if(v>-1){y.splice(v,1)}if(y.length<1){w.unbind("touchstart",d).unbind("touchend",b)}s(w)};h.fn.swipe=function(x,w){this.unswipe();this.data(q,x);var v=this.data(m)===true?true:false;this.data(m,(w===true?true:v));i(this,"swipe");return this};h.fn.unswipe=function(){this.data(q,null);this.data(m,null);o(this,"swipe");return this};h.fn.unSwipe=h.fn.unswipe;h.fn.touchDrag=function(z,v,x){var w=typeof v=="object"?v:null,y=0;if(!x||typeof x==r){y=3}else{y+=(x.indexOf("x")>-1?1:0);y+=(x.indexOf("y")>-1?2:0)}this.unTouchDrag();this.data(f,z);this.data(l,w||document);this.data(a,y);this.data(m,true);i(this,"touchDrag");return this};h.fn.unTouchDrag=function(){this.data(f,null);this.data(l,null);this.data(m,null);this.data(a,0);o(this,"touchDrag");return this}})(jQuery);